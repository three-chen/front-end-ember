{"version":3,"file":"ember.js","sources":["../../src/compiler/astParser.js","../../src/compiler/index.js","../../src/initMixin.js","../../src/index.js"],"sourcesContent":["// Regular Expressions for parsing tags and attributes\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`//标签名\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\r\nconst startTagClose = /^\\s*(\\/?)>/\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\r\n\r\nfunction parseHtmlToAst(html) {\r\n    let total = 0;\r\n    let text = html;\r\n    let status = \"tag_open\";\r\n    let match = {\r\n        sel: {},\r\n        attrs: {},\r\n        text: \"\",\r\n    };\r\n\r\n    while (text) {\r\n        switch (status) {\r\n            case \"tag_open\":\r\n                matchTagOpen();\r\n                break;\r\n            case \"tag_start\":\r\n                matchTagStart();\r\n                break;\r\n            case \"tag_attribute\":\r\n                matchTagAttribute();\r\n                break;\r\n            case \"tag_end\":\r\n                matchTagEnd();\r\n                end(match);\r\n                break;\r\n            case \"text\":\r\n                matchText();\r\n                break;\r\n            case \"tag_close\":\r\n                status = \"tag_open\";\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    function matchTagOpen() {\r\n        total++;\r\n        let endTagMatch = text.match(endTag);\r\n        console.log(total, endTagMatch, text);\r\n        if (!endTagMatch) {\r\n            if (text.indexOf('<') === 0) {\r\n                status = \"tag_start\";\r\n            }\r\n        } else {\r\n            text = undefined;\r\n        }\r\n        if (total > 2) {\r\n            text = undefined;\r\n        }\r\n    }\r\n\r\n    function matchTagStart() {\r\n        const startTagMatch = text.match(startTagOpen);\r\n        if (startTagMatch) {\r\n            match.sel = startTagMatch[1];\r\n            advance(startTagMatch[0].length);\r\n            status = \"tag_attribute\";\r\n        } else {\r\n            advance(text.indexOf('>'));\r\n            status = \"tag_end\";\r\n        }\r\n    }\r\n\r\n    function matchTagAttribute() {\r\n        const attributeMatch = text.match(attribute);\r\n        if (attributeMatch) {\r\n            match.attrs[attributeMatch[1]] = attributeMatch[3] || attributeMatch[4] || attributeMatch[5];\r\n            advance(attributeMatch[0].length);\r\n            status = \"tag_attribute\";\r\n        } else {\r\n            status = \"tag_end\";\r\n        }\r\n    }\r\n\r\n    function matchTagEnd() {\r\n        const endMatch = text.match(startTagClose);\r\n        advance(endMatch[0].length);\r\n        status = \"text\";\r\n    }\r\n\r\n    function matchText() {\r\n        match.text += text.substring(0, text.indexOf('<'));\r\n        if (match.text) {\r\n            advance(match.text.length);\r\n        }\r\n        status = \"tag_open\";\r\n    }\r\n\r\n    function start(tagname, attrs) {\r\n        console.log(\"start:\", tagname, attrs);\r\n    }\r\n\r\n    function end(match) {\r\n        console.log(\"end:\", match);\r\n    }\r\n\r\n    function chars(text) {\r\n        console.log(\"chars\", text);\r\n    }\r\n\r\n    function createAstElement(tagname, attrs) {\r\n        return {\r\n            type: 1,\r\n            tag: tagname,\r\n            attrs,\r\n            children: [],\r\n            // parent:\r\n        }\r\n    }\r\n\r\n    function advance(length) {\r\n        text = text.substring(length);\r\n    }\r\n}\r\nexport {\r\n    parseHtmlToAst\r\n}\r\n\r\n","import { parseHtmlToAst } from \"./astParser\";\r\nfunction createRenderFunction(html) {\r\n    const ast = parseHtmlToAst(html);\r\n}\r\n\r\nexport {\r\n    createRenderFunction\r\n};\r\n\r\n","// import initState from './initState';\r\nimport { createRenderFunction } from './compiler';\r\n\r\nfunction initMixin(Ember) {\r\n    Ember.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;\r\n        // initState(vm);\r\n        // initRender(vm);\r\n        if (vm.$options.el) {\r\n            vm.$mount(vm.$options.el);\r\n        }\r\n    }\r\n\r\n    Ember.prototype.$mount = function (el) {\r\n        const vm = this, options = vm.$options;\r\n        vm.$el = document.querySelector(el);\r\n        if (!options.render) {\r\n            options.render = createRenderFunction(vm.$el.outerHTML);\r\n        }\r\n        // options.render();\r\n    }\r\n}\r\n\r\nexport {\r\n    initMixin\r\n};\r\n\r\n","import { initMixin } from './initMixin';\r\n\r\nfunction Ember(options) {\r\n    this._init(options);\r\n}\r\n\r\ninitMixin(Ember);\r\n\r\nexport default Ember;"],"names":["attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","parseHtmlToAst","html","total","text","status","match","sel","attrs","matchTagOpen","matchTagStart","matchTagAttribute","matchTagEnd","end","matchText","endTagMatch","console","log","indexOf","undefined","startTagMatch","advance","length","attributeMatch","endMatch","substring","createRenderFunction","initMixin","Ember","prototype","_init","options","vm","$options","el","$mount","$el","document","querySelector","render","outerHTML"],"mappings":"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"}